pipeline {
  agent any

  tools {
    nodejs "node"
  }

  parameters {
    string(name: "container_name", defaultValue: "vueapp", description: "Nombre del contenedor de docker")
    string(name: "image_name", defaultValue: "vueapp_img", description: "Nombre de la imagen de docker")
    string(name: "image_tag", defaultValue: "latest", description: "Tag latest de la imagen de docker")
    string(name: "container_port", defaultValue: "80", description: "Puerto de Nginx")
  }

  stages {
    stage('clone') {
      steps {
        git branch: 'develop', url: 'https://github.com/YirsisHertz/jenkins_vue_app.git'
        sh 'sudo ln -sf "$(which node)" /usr/bin/node'
      }
    }

    stage('install') {
      steps {
        dir('jenkins_vue_app') {
          sh 'npm install'
        }
      }
    }

    stage('test') {
      steps {
        sh 'npm run test'
      }
    }
  }

}